<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <title>Database Backup & Restore</title>
    <link rel="stylesheet" href="/static/styles/admin_backup.css">
</head>
<body>
    <div class="container">
        <div class="navigation">
            <button onclick="goBack()">← Tilbake</button>
            <button onclick="logout()">Logg Ut</button>
        </div>

        <h1>Backup & Restore</h1>

        <h2>Last ned eksisterende backup</h2>
        <form action="/admin/backup" method="get">
            <button type="submit">Last ned backup_database.txt</button>
        </form>

        <h2>Gjenopprett database fra backup</h2>
        <form action="/admin/restore" method="post" enctype="multipart/form-data">
            <input type="file" name="file" accept=".txt,.json" required>
            <button type="submit">Last opp og gjenopprett</button>
        </form>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const token = localStorage.getItem('token');

            if (!token) {
                window.location.href = "/";
                return;
            }

            fetch("/api/admin/data", {
                headers: { "Authorization": `Bearer ${token}` }
            })
            .then(res => {
                if (!res.ok) throw new Error("Unauthorized");
                return res.json();
            })
            .then(data => {
                console.log("Bruker er autorisert.");
                // her kan du laste data fra backend hvis ønskelig
            })
            .catch(err => {
                console.error("Uautorisert tilgang:", err);
                localStorage.removeItem('token');
                window.location.href = "/";
            });
        });
        function goBack() {
            window.history.back();
        }

        function logout() {
            localStorage.removeItem('token');
            window.location.href = "/";
        }
    </script>
</body>
</html>
